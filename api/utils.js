// 提取 SVG 内容（去除外层 svg 标签）
export function extractSvgContent(svgString) {
    const match = svgString.match(/<svg[^>]*>([\s\S]*)<\/svg>/i);
    return match ? match[1] : svgString;
}

// 装饰图案库
export const decorations = {
    cloud: {
        x: '400',
        y: '0',
        width: '80',
        viewBox: '0 0 230.7 357.6',
        path: `M1045.4,483.4c40.5-5.7,81.4-2,122.1-3.7,7.4-.1,7.4-.1,7.5-7.6s4.5-14.6,12.6-12.1-.5,17.9,8.6,19.2c12.6.7,25.2,2.6,37.6-2,8.9-3.3,12.9-.5,13.3,9s-1.8,15.3-11.5,11.7c-11.5-3.7-23.1-2.9-34.7-2.6-8.3.3-8.4.6-8.9,8.9s-3.2,11-11.5,9c-11.2-4.4,1.7-18.9-16.5-17.1C1124.9,493.3,1080.5,504.6,1045.4,483.4Z`,
        transform: 'translate(-1045.4 -302.8)',
        animation: `
      <animateTransform
        attributeName="transform"
        attributeType="XML"
        type="translate"
        values="-1045.4,-302.8; -1045.4,-320.8; -1045.4,-310.8; -1045.4,-325.8; -1045.4,-302.8"
        keyTimes="0; 0.25; 0.5; 0.75; 1"
        dur="5s"
        repeatCount="indefinite"/>
    `
    },

    cat: {
        x: '260',
        y: '20',
        width: '300',
        height: '150',
        viewBox: '0 0 230.7 357.6',
        path: `M1269.4,366.4c2.7-25,8.9,4.3,18.4-6.4,6.2-8.2,11,.9,18.6,1.2,24.6,3.8,51.8,7.9,68.1,28.9,10.4,13.7,12.8,32,14.3,48.7.1,7.6,3.4,13,9.3,17.3,8.2,5.2-3.6,5-7.6,4.1.9,7.1,1.7,14,2.8,22.1-4.8-3.7-4.5-8.6-7.3-12.2-2,4.4,4.2,8.1-.6,12-1.3,1-.2,4.1.1,6.3s.3,2.2-2.3,1.8-.3,3.1-3.1,2.5c-1.6-3.6-1.9-7.9-3.5-12,1,5.3-5,9-2.9,14.7.7,2.1,1.4,3.8,3.7,3.9,15.9,1.1,19.3,16,25.3,28.2,2.5-4.9,9.8-9.2,3.7-14.1-2.7-2.1-1.7-5.2,1.6-6.4s8.8-4.8,13-7.4c12.1-6.9-10.7-12.1.8-14.1,2.1-.4,1-2.7.3-3.8-5.3-9.1-4.5-19-4.3-28.8,2.1-7.3,2.6-14.4.2-21.8-1.3-4.3,5.9-7,3.3-11.3s-10.4,3.9-12.3-3.3,10.2-4.1,10.6-9.4c-1.1-19.9-5.9-39.9-6.7-60-.7-4.2,3.6-32.6,7.3-21.9,5.7,24.1,7.2,49,10.9,73.5-.1,13.8,11.3-1,14.8,8.2,1.6,5.9-5.4,6-9.2,7.3s-3.6,7,0,7.3c7.9.8,9.1,6.5,10.7,12.9a58.3,58.3,0,0,0,9.1,20.2c10.7,15.5-9.5,33.1,10.7,35.4,3.6.3,3.8,3.2.4,4.3-20.7,10.9-10.6,24.4-13.8,42.2-.6,3.7-3.2,3-5.7,1.5-5.7-3.5-5.9-3.6-9,2.3-7.2,13.7-14.3,27.5-21.4,41.2-2.2,4.3.6,9.1-1.7,13.4-.4.7,1.3,1.2,2.2,1.7a21.6,21.6,0,0,0,8.4,2.9c6.6.7,14.6,8.1,14.7,14.2-3.5,3.6-.7,5.9,1.3,8.8,5.4,7.3,3.6,11.5-5.5,13-3.5.8-1.7,7.8-1.9,10.8,2,11.7-12.5,10.7-17.1,18.8s-13.1,9.7-19.5,14.6c-1,.8-2.9.7-4.3.7-41,0-82-.1-123,0-3.8.1-5.9-1.1-7-4.8-1.8-6-5.4-11-9.3-15.8s-25-34-10.8-33.2c14.4-2,28.5.8,42.7,2.6,4.5-.7,17.3,6.8,15.1-2.2-2.8-25.5-18.9-47.2-21.5-72.4-2.8-16-12.4-25.2,1.7-40.6,3.8-1.6,5.2-18,.3-12.4-9.6,7.4,12.9-26.9-17.3-38.3-24.8-11.6-21.4-37.2-10.2-57.7.8-1.9.7-2.8-1.2-4-20.4-11.7,10.8-16.5-1.7-26-4.9-4.5-4.8-5.1,1.2-7.9C1261.5,363.9,1264.1,363.6,1269.4,366.4Zm26,136.6c4.6-.2,18.8,2.8,18.6-3.9-.5-2.1-1.7-1.5-3-1.3-3.4,1.4-7.1-3.2-8.4,2.1s-3.8-1.4-4.5-4.1C1297,498.6,1296.3,500.5,1295.4,503Z`,
        transform: 'translate(-1239.4 -322.8)',
        animation: ''
    }
};

// 获取装饰 SVG
export function getDecorationSvg(decorationType = 'cloud', customX, customY) {
    const decoration = decorations[decorationType];
    if (!decoration) return '';

    const x = customX || decoration.x;
    const y = customY || decoration.y;
    const width = decoration.width || '80';
    const height = decoration.height || '';
    const heightAttr = height ? `height="${height}"` : '';

    return `
    <svg x="${x}" y="${y}" width="${width}" ${heightAttr} viewBox="${decoration.viewBox}" fill-opacity="0.2" xmlns="http://www.w3.org/2000/svg">
      <path d="${decoration.path}" transform="${decoration.transform}">
        ${decoration.animation}
      </path>
    </svg>
  `;
}

// 获取 GitHub Stats SVG
export async function fetchGithubStats(baseUrl, params) {
    const queryString = new URLSearchParams(params).toString();
    const url = `${baseUrl}?${queryString}`;

    const response = await fetch(url);
    if (!response.ok) {
        throw new Error(`Failed to fetch from ${baseUrl}`);
    }

    return await response.text();
}